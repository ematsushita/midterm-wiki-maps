<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <title>bucket! Lists for your Life.</title>

    <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" type="text/css" />
    <link rel="stylesheet" href="/vendor/border-box.css" type="text/css" />
    <link rel="stylesheet" href="/styles/layout.css" type="text/css" />

    <script type="text/javascript" src="/vendor/jquery-3.0.0.js"></script>
    <script type="text/javascript" src="/scripts/app.js"></script>
    <script type="text/javascript" src="/scripts/search.js"></script>
  </head>

  <body>

    <!--Import navbar header-->
    <%- include('./partials/_header') %>

    <!--Search/Add Bar-->
    <div class="container-fluid my-3">
      <form class="active-purple-3 active-purple-4">
        <div class="row align-items-center">
          <div class="col-8">
            <input id="autocomplete" class="form-control form-control-sm" type="text" placeholder="Search"
            aria-label="Search">
          </div>
          <div class="col-auto">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search mx-2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            <button class="btn btn-purple add-point-dropdown">Add Point</button>
          </div>
        </div>
      </form>
    </div>

    <!-- Create new Point form -->
    <section class="add-new-point">
      <form class="new-point" action="/points/<%= list.id %>/add" method="POST">
        <div class="form-group">
          <label class="form-header">Title</label>
          <input required name="title" type="text" class="form-control" placeholder="Title">
        </div>
        <div class="form-group">
          <label class="form-header">Description</label>
          <textarea required name="description" class="form-control" placeholder="Description"></textarea>
        </div>
        <div class="form-group">
          <label class="form-header">Latitude</label>
          <input required name="latitude" class="form-control">
        </div>
        <div class="form-group">
          <label class="form-header">Longitude</label>
          <input required name="longitude" class="form-control">
        </div>
        <form>
            <button class="btn btn-purple text-white my-2">Add Point!</button>
        </form>
      </form>
    </section>

    <!--Map Embed-->
    <div id="map">
    </div>

    <script>
      function initMap() {

        const coords = [
          {lat: <%= Number(bounds.south) %>, lng: <%= Number(bounds.west) %>},
          {lat: <%= Number(bounds.north) %>, lng: <%= Number(bounds.east) %>}
        ];

        const mapBounds = new google.maps.LatLngBounds();
        const centre = mapBounds.getCenter();

        const map = new google.maps.Map(document.getElementById('map'), {zoom: 10, center: centre});

        <% for (let i = 0; i < points.length; i++) { %>
          const coord<%= i %> = {lat: <%= points[i].latitude %>, lng: <%= points[i].longitude %>}
          const marker<%= i %> = new google.maps.Marker({position: coord<%= i %>, map: map});
          mapBounds.extend(coord<%= i %>)
        <% } %>

        map.fitBounds(mapBounds, 5)

        const autocomplete = new google.maps.places.Autocomplete(document.getElementById('autocomplete'));

      }
    </script>

    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDy_IDF1mSWDBrRnP-2VFToDQcwUl4LcvA&libraries=places&callback=initMap">
      </script>

    <!--Map Title/Desc -->
    <div class="container">
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-heart"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
        <%= list.title %>
      </h2>
      <p>
        <%= list.description %>
      </p>
      <hr>
    </div>

    <!-- Map Points -->
    <div class="container">
      <h2>Points of Interest</h2>
      <table class="table">
        <tbody>
          <% for (let i = 0; i < points.length; i++) { %>
            <tr id="point-<%= points[i].id %>">
              <td><%= points[i].title %></td>
              <td><a href="">edit</a></td>
              <td><a href=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></a></td>
            </tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </body>
</html>
